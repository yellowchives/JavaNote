## 加密算法

古典密码学主要使用移位、替代等方法加密，但随着频率分析法的提出，古典密码学的方法都失效了。

现代密码学在加密算法上大体可分为**单向加密算法、对称加密算法、非对称加密算法**三大类。

单向加密算法只能加密不能解密，是数据完整性验证的常用算法，其实就是各种类型的哈希函数。典型代表是MD5、SHA、MAC算法。

对称加密算法是数据存储加密的常用算法，又称单钥密码算法或私钥密码算法。典型代表是DES、AES算法。

对称密码体制并不是现代密码学的新生产物，它是古典密码学的进一步延续。古典密码常用的两种技巧—替代和移位，仍然是对称密码体制中最重要的加密技巧。

对称密码体制分为两种：一种是对明文的单个位（或字节）进行加密和解密，称为流密码，又称为序列密码；另一种是把明文信息划分成不同的组（或块）结构，分别对每个组（或块）进行加密和解密，称为分组密码。

流密码是军事、外交等机要部门中应用最为广泛的对称密码体制。同时，它也是手机应用平台最常用的加密手段。流密码实现较为简单，加密时将明文按字符（或字节）逐位进行加密，解密时将密文按字符（字节）逐位解密。加密、解密可以是简单的位运算，如模n运算。明文加密后，生成的密文几乎和明文保持同样的长度。

分组密码多应用于网络加密，是对称密码体制中发展最为完善的密码体制。分组密码对固定长度的一组明文进行加密，这一固定长度称为分组长度。分组长度是分组密码的一个参数，它与分组算法的安全性成正比，其取值范围取决于实际应用的环境。为保证分组算法的安全性，分组长度越长越好，分组长度越长，密码分析越困难；为保证分组密码的实用性，分组长度越短越好，分组长度越短，越便于操作和运算。分组长度的设定需要权衡分组算法的安全性与实用性，一般设置为56位。但随着密码学的发展，分组长度只有56位的分组密码已经不能确保算法的安全性。目前，分组密码多选择128位作为算法的分组长度。

非对称加密算法是数据传输加密的常用算法，又称双钥密码算法或公钥密码算法。典型代表是RSA、ECC算法

对称加密算法也可以用做数据传输加密，但非对称加密算法在密钥管理方面更有优势。相对对称加密算法而言，非对称加密算法在安全级别上等级更高，但非对称加密算法在时间效率上远不如对称加密算法，非对称加密需要的密钥长度远大于对称加密。

## 密码学术语

* 明文：plaintext
* 密文：ciphertext
* 加密：encryption
* 解密：decryption
* 密码分析：cryptanalysis
* 密钥空间：keyspace，一种密码能够使用的所有密钥的集合
* 被动攻击：passiveattack，指对一个保密系统采取截获密文并对密文进行分析和攻击的行为。这种攻击对密文没有破坏作用。
* 主动攻击：activeattack，指攻击者非法入侵密码系统，采用伪造、修改、删除等手段向系统注入假消息进行欺骗的行为。这种攻击对密文具有破坏作用。
* 柯克霍夫原则Kerckhoffs'Principle：数据的安全基于密钥而不是算法的保密。也就是说算法可以公开，但是密钥必须保密。这是现代密码学设计的基本原则。古典密码学主要是保密算法，而现代密码学是保密密钥。
* 对称密码算法：symmetriccipher
* 非对称密码系统：asymmetriccipher

## 对称加密

### 基本原理

使用异或运算，因为`a^b^b=a`，这里的a相当于明文的比特序列，b相当于密钥的比特序列。因为明文和密钥的长度一般不一样，所以一般使用流密码或者分组密码来加密。

### DES

DES（DataEncryptionStandard）：最早广泛使用的对称加密算法，现已被AES取代。它是一种将64比特的明文加密成64比特的密文的对称密码算法，它的密钥长度是56比特。尽管从规格上来说，DES的密钥长度是64比特，但由于每隔7比特会设置一个校验码，因此实质上其密钥长度是56比特。

DES是以64比特的明文（比特序列）为一个单位来进行加密的，这个64比特的单位称为分组。一般来说，以分组为单位进行处理的密码算法称为分组密码(blockcipher)，DES就是分组密码的一种。

DES使用轮函数，每次加密一部分明文，一直重复直到所有明文都被加密为止。

### AES

AES（AdvancedEncryptionStandard），也是分组加密算法，它没有使用轮函数，而是使用了SPN结构，有点像矩阵的运算。

#### 分组密码的模式

DES和AES都是分组密码，都只能加密固定长度的明文。如果需要加密任意长度的明文，就需要对分组密码进行迭代，而分组密码迭代的方式就叫做分组密码的”模式“。

分组密码 block cipher 每次只能处理固定的比特数，叫做分组长度。DES的分组长度是64bit，AES是128bit。流密码是对数据流进行连续处理的加密算法，一般以1bit、8bit、32bit等单位进行处理。分组密码处理完一个分组就结束了，因此不需要通过内部状态来记录加密的进度；相对地，流密码需要记录内部状态。

如果明文的长度超过分组的长度，就必须对分组密码进行迭代，分组密码的迭代模式主要有5种。

##### ECB模式


## JavaAPI

JavaAPI支持多种加密算法。如MessageDigest类，可以构建MD5、SHA两种加密算法；Mac类可以构建HMAC加密算法；Cipher类可以构建多种加密算法，如DES、AES、Blowfish对称加密算法，以及RSA、DSA、DH等多种非对称加密算法；Signature类可以用于数字签名和签名验证；Certificate类可用于操作证书；等等。

### 对称加密

对称加密速度快，加密后编码表找不到对应的字符，出现乱码。一般结合base64一起使用。

### MessageDigest类

MD5加密：MD5主要用做数据一致性验证、数字签名和安全访问认证，而不是用作加密。比如说用户在某个网站注册账户时，输入的密码一般经过MD5编码，更安全的做法还会加一层盐（salt），这样密码就具有不可逆性。然后把编码后的密码存入数据库，下次登录的时候把密码MD5编码，然后和数据库中的作对比，这样就提升了用户账户的安全性。

SHA全名叫做安全散列算法，是FIPS所认证的安全散列算法，比MD5的安全性更高。

```java
publicclassMDTest{

//支持下面三种算法
publicstaticfinalStringKEY_MD5="MD5";
publicstaticfinalStringSHA="SHA";
publicstaticfinalStringSHA_256="SHA_256";

publicstaticvoidmain(String[]args)throwsNoSuchAlgorithmException{

//MessageDigestsha=MessageDigest.getInstance("SHA");
MessageDigestsha=MessageDigest.getInstance("MD5");
byte[]bytes="helloworld".getBytes(StandardCharsets.UTF_8);
sha.update(bytes);
byte[]digest=sha.digest();
System.out.println(newString(digest,StandardCharsets.UTF_8));
}
}
```

