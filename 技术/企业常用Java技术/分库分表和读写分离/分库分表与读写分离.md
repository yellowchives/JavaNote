## 分库分表

垂直切分: 

- 就是把不同业务使用不同的数据库, 比如把用户和订单放到不同的库中.

- 缺点: 部分业务表无法join; 跨库事务难以处理; 某些业务数据量太大, 单表还是无法保存.

水平切分: 

- 将一张表的数据按照某种规则分到不同的库中.

- 缺点: 查询麻烦; 分片事务一致性难以解决; 拓展时数据迁移麻烦

## 读写分离

读写分离的问题有两个:

1. 如果写库有多个, 怎么分片?
2. 怎么解决同步的问题? 怎么解决同步挂了, 或者同步延迟比较大时的不一致性?

## MyCat

MyCat 是一个解决 MySQL 分库分表的中间件, 典型的应用场景有:

1. 单独读写分离: 此时配置最简单, 支持读写分离和主从切换.
2. 分库分表: 最大支持1000亿的数据.
3. 多租户应用: 每个应用一个数据库, 应用只连接 MyCat, 程序不用改造.

rule.xml 用于定义 MyCat 的分片规则, 支持以下规则:

1. rang-long 按主键范围分片
2. murmur 一致性hash, 可以将数据平均分在几个分区中

## Sharding-Jdbc

Sharding-Jdbc 是客户端代理, MyCat 是服务端代理. 

Sharding-Jdbc 支持同一个库内的水平切分, MyCat 不支持.
