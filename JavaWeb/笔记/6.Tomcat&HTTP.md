## 企业开发简介

### JavaEE规范

`JavaEE`规范是很多`Java`开发技术的总称。这些技术规范都是沿用自`J2EE`的。一共包括了13个技术规范。例如：`jsp/servlet`，`jndi`，`jaxp`，`jdbc`，`jni`，`jaxb`，`jmf`，`jta`，`jpa`，`EJB`等。

### web服务器

服务器：安装了服务器软件的计算机

服务器软件：接收用户的请求，处理请求，做出响应。在web服务器软件中，可以部署web项目，让用户通过浏览器访问网站。

常见的java相关的web服务器软件：

| 服务器名称  | 说明                                                  |
| ----------- | ----------------------------------------------------- |
| weblogic    | 实现了javaEE规范，重量级服务器，又称为javaEE容器      |
| websphereAS | 实现了javaEE规范，重量级服务器。                      |
| JBOSSAS     | 实现了JavaEE规范，重量级服务器。免费的。              |
| Tomcat      | 实现了jsp/servlet规范，是一个轻量级服务器，开源免费。 |

## Tomcat

1. 下载：http://tomcat.apache.org/、

2. 安装：解压压缩包即可。

3. 卸载：删除目录就行了

4. 目录结构：
   ![](D:\Program Files\Typora\Java\image\tomcat目录结构详解.png)

5. 启动：
   双击运行：bin/startup.bat。然后再浏览器输入localhost:8080即可访问

   * 如果同时开始两个tomcat会报错，因为默认的8080端口被占用了。解决方案：

     * 暴力：cmd - >netstat -ano找到占用8080端口的进程，杀死该进程
     * 温柔：修改端口号。打开conf/server.xml。把里面的所有端口都改了。一般会将tomcat的默认端口号修改为80，因为80端口号是http协议的默认端口号，不用手动输入。
   * startup.bat闪退，需要设置环境变量：JAVA_HOME，CATALINA_HOME，在path里添加%CATALINA_HOME%\bin和%CATALINA_HOME%\lib
   
6. 关闭
   强制关闭：点右上角的X。
   正常关闭：bin/shutdown.bat，快捷键ctrl+c

7. 配置

   1. 部署项目的方法
      1. 直接将项目放到webapps目录下即可。访问：localhost:8080/hello/hello.html
         项目的访问路径变成了虚拟目录
         简化部署：将项目打成一个war包，再将war包放置到webapps目录下。war包会自动解压缩
      2. 配置conf/server.xml文件
         在\<Host>标签体中添加：\<Context docBase="D:\hello" path="/hehe" />
         docBase:项目存放的路径
         path：虚拟目录
      3. 在conf/catalina/localhost创建任意名称的xml文件。在文件中编写：\<Context docBase="D:\hello" />
         虚拟目录设置成xml文件的名称
   2. tomcat中JavaWeb项目的目录结构
      ![](D:\Program Files\Typora\Java\image\epub_35449554_67.jpg)

## HTTP

Hyper Text Transfer Protocol 超文本传输协议，定义了客户端和服务器通信时发送数据的格式
![](D:\Program Files\Typora\Java\image\epub_35449554_45.jpg)

特点

1. 基于TCP/IP的高级协议
2. 默认端口号:80
3. 基于请求/响应模型的:一次请求对应一次响应
4. 灵活：HTTP允许传输任意类型的数据，正在传输的数据类型由Content-Type加以标记。
5. 无状态的：每次请求之间相互独立，如果后续处理需要前面的信息只能重传

历史版本：

* 1.0：每一次请求响应都会建立新的连接
* 1.1：复用连接

### 请求消息数据格式

1. 请求行（第1行)：请求方式 资源路径 http版本
   GET /login.html HTTP/1.1
   http协议有7中请求方式，常用的有2种

   1. GET：
      1. 请求参数在请求行中，在url后。`http://www.itcast.cn/javaForum?name=lee&psd=hnxy`
      2. 传送的数据量有限，最多2KB。
   2. POST：
      1. 请求参数在请求体中，传递数据的大小没有限制
      2. 更加安全

2. 请求头：包含客户端的信息

   | 内容                   | 说明                                                         |
   | ---------------------- | ------------------------------------------------------------ |
   | Accept                 | 告知服务器，客户浏览器所支持的MIME类型。                     |
   | Accept-Encoding        | 告知服务器，客户浏览器所支持的压缩编码格式。最常用的就是gzip压缩。 |
   | Accept-Language        | 告知服务器，客户浏览器所支持的语言。一般都是zh_CN或en_US等。 |
   | Referer                | 告知服务器，当前请求的来源，即当前tag的上一个网页地址。只有当前请求有来源的时候，才有这个消息头。从地址栏输入的没有来源。 |
   | Content-Type           | 告知服务器，请求正文的MIME类型。                             |
   | Content-Length         | 告知服务器，请求正文的长度。                                 |
   | User-Agent             | 浏览器相关信息                                               |
   | Connection: Keep-Alive | 连接的状态：保持连接                                         |
   | If-Modified-Since      | 告知服务器，客户浏览器缓存文件的最后修改时间。               |
   | **Cookie**             | 会话管理相关，非常的重要。                                   |

   ```http
   Host:localhost:8080   主机虚拟地址
   Connection:keep-alive 长连接
   Upgrade-Insecure-Requests: 1  请求协议的自动升级[http的请求，服务器却是https的，浏览器自动会将请求协议升级为https的]
   User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.75 Safari/537.36
   - 用户系统信息
   Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
   - 浏览器支持的文件类型
   Referer: http://localhost:8080/05_web_tomcat/login.html
   - 当前页面的上一个页面的路径[当前页面通过哪个页面跳转过来的]：可以通过此路径跳转回上一个页面，广告计费，防止盗链
   Accept-Encoding: gzip, deflate, br
   - 浏览器支持的压缩格式
   Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
   - 浏览器支持的语言
   ```

3. 空行：分割请求头和请求体

4. 请求体(正文)：封装POST请求参数的，GET方式没有。

###  响应消息数据格式

响应消息：服务器发送给客户端的消息

```http
HTTP/1.1 200 OK
Content-Type: text/html;charset=UTF-8
Content-Length: 101
Date: Wed, 06 Jun 2018 07:08:42 GMT

<html>
    <head>
        <title>$Title$</title>
    </head>
    <body>
        hello , response
    </body>
</html>
```

1. 响应行

   1. 组成：协议/版本 状态码 状态码描述 `HTTP/1.1 200 OK`

   2. 状态码：

      | 状态码  | 说明                                             |
      | ------- | ------------------------------------------------ |
      | 200     | 一切都OK>                                        |
      | 302/307 | 请求重定向(客户端行为，两次请求，地址栏发生改变) |
      | 304     | 请求资源未发生变化，使用缓存                     |
      | 404     | 请求资源未找到                                   |
      | 500     | 服务器错误                                       |

2. 响应头

   1. 格式：头名称： 值

   2. 常见的响应头：

      | 消息头                  | 说明                                                         |
      | ----------------------- | ------------------------------------------------------------ |
      | Location                | 请求重定向的地址，常与302,307配合使用。                      |
      | Server                  | 服务器相关信息。                                             |
      | Content-Type            | 告知客户浏览器，响应正文的MIME类型。                         |
      | Content-Length          | 告知客户浏览器，响应正文的长度。                             |
      | Content-Encoding        | 告知客户浏览器，响应正文使用的压缩编码格式。常用的gzip压缩。 |
      | Content-Language        | 告知客户浏览器，响应正文的语言。zh_CN或en_US等等。           |
      | Content-Disposition     | 告知客户浏览器，以下载的方式打开响应正文。                   |
      | Refresh                 | 定时刷新 `Refresh:3;url=http://www.itcast.cn`                |
      | Last-Modified           | 服务器资源的最后修改时间。                                   |
      | Set-Cookie              | 会话管理相关，非常的重要                                     |
      | Expires:-1              | 服务器资源到客户浏览器后的缓存时间                           |
      | Catch-Control: no-catch | 不要缓存，//针对http协议1.1版本                              |
      | Pragma:no-catch         | 不要缓存，//针对http协议1.0版本                              |

3. 空行

4. 响应体：传输的数据，可以是html文档。

